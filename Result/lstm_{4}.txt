Building prefix dict from the default dictionary ...
Loading model from cache /tmp/jieba.cache
Loading model cost 0.869 seconds.
Prefix dict has been built successfully.
/home/zhyidi/Graduation_Project/lstm.py:115: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1670525495809/work/torch/csrc/utils/tensor_new.cpp:230.)
  vectors = torch.Tensor(vectors)
epoch:1, step:10, loss:0.6863011121749878
epoch:1, step:20, loss:0.6643039584159851
epoch:1, step:30, loss:0.6392688751220703
epoch:1, step:40, loss:0.5875006318092346
epoch:1, step:50, loss:0.49650734663009644
epoch:1, step:60, loss:0.4736038148403168
epoch:1, step:70, loss:0.46486157178878784
epoch:1, step:80, loss:0.44871339201927185
epoch:1, step:90, loss:0.4579537808895111
epoch:1, step:100, loss:0.4300389885902405
              precision    recall  f1-score   support

         0.0       0.66      0.85      0.74       155
         1.0       0.92      0.80      0.86       345

    accuracy                           0.82       500
   macro avg       0.79      0.83      0.80       500
weighted avg       0.84      0.82      0.82       500

准确率: 0.816
AUC: 0.9114726507713884
saved model:  ./model/lstm_1.model
epoch:2, step:10, loss:0.43812957406044006
epoch:2, step:20, loss:0.45088982582092285
epoch:2, step:30, loss:0.4204069972038269
epoch:2, step:40, loss:0.3997974395751953
epoch:2, step:50, loss:0.3747406601905823
epoch:2, step:60, loss:0.3950548768043518
epoch:2, step:70, loss:0.4328148365020752
epoch:2, step:80, loss:0.4315817356109619
epoch:2, step:90, loss:0.3712509274482727
epoch:2, step:100, loss:0.3916461169719696
              precision    recall  f1-score   support

         0.0       0.75      0.77      0.76       155
         1.0       0.90      0.89      0.89       345

    accuracy                           0.85       500
   macro avg       0.83      0.83      0.83       500
weighted avg       0.85      0.85      0.85       500

准确率: 0.852
AUC: 0.9201870032725573
saved model:  ./model/lstm_2.model
epoch:3, step:10, loss:0.3722037971019745
epoch:3, step:20, loss:0.3733842074871063
epoch:3, step:30, loss:0.34700503945350647
epoch:3, step:40, loss:0.38257884979248047
epoch:3, step:50, loss:0.36118990182876587
epoch:3, step:60, loss:0.3891429305076599
epoch:3, step:70, loss:0.39738520979881287
epoch:3, step:80, loss:0.36763811111450195
epoch:3, step:90, loss:0.38287025690078735
epoch:3, step:100, loss:0.3360395133495331
              precision    recall  f1-score   support

         0.0       0.66      0.88      0.76       155
         1.0       0.94      0.80      0.86       345

    accuracy                           0.82       500
   macro avg       0.80      0.84      0.81       500
weighted avg       0.85      0.82      0.83       500

准确率: 0.824
AUC: 0.9280972417017298
saved model:  ./model/lstm_3.model
epoch:4, step:10, loss:0.3187693953514099
epoch:4, step:20, loss:0.3769194483757019
epoch:4, step:30, loss:0.39976388216018677
epoch:4, step:40, loss:0.34909865260124207
epoch:4, step:50, loss:0.35505348443984985
epoch:4, step:60, loss:0.34075814485549927
epoch:4, step:70, loss:0.33531665802001953
epoch:4, step:80, loss:0.31723862886428833
epoch:4, step:90, loss:0.32532086968421936
epoch:4, step:100, loss:0.36573654413223267
              precision    recall  f1-score   support

         0.0       0.71      0.85      0.78       155
         1.0       0.93      0.85      0.88       345

    accuracy                           0.85       500
   macro avg       0.82      0.85      0.83       500
weighted avg       0.86      0.85      0.85       500

准确率: 0.848
AUC: 0.931706404862085
saved model:  ./model/lstm_4.model
epoch:5, step:10, loss:0.3042035400867462
epoch:5, step:20, loss:0.29843127727508545
epoch:5, step:30, loss:0.3391156792640686
epoch:5, step:40, loss:0.3363231420516968
epoch:5, step:50, loss:0.32413074374198914
epoch:5, step:60, loss:0.3074079751968384
epoch:5, step:70, loss:0.2962495684623718
epoch:5, step:80, loss:0.32941123843193054
epoch:5, step:90, loss:0.28388386964797974
epoch:5, step:100, loss:0.3187864124774933
              precision    recall  f1-score   support

         0.0       0.76      0.74      0.75       155
         1.0       0.89      0.90      0.89       345

    accuracy                           0.85       500
   macro avg       0.82      0.82      0.82       500
weighted avg       0.85      0.85      0.85       500

准确率: 0.848
AUC: 0.9221879382889201
saved model:  ./model/lstm_5.model
epoch:6, step:10, loss:0.2631441652774811
epoch:6, step:20, loss:0.27812981605529785
epoch:6, step:30, loss:0.28692296147346497
epoch:6, step:40, loss:0.30671292543411255
epoch:6, step:50, loss:0.2841106057167053
epoch:6, step:60, loss:0.2647706866264343
epoch:6, step:70, loss:0.27766498923301697
epoch:6, step:80, loss:0.27261418104171753
epoch:6, step:90, loss:0.2684656083583832
epoch:6, step:100, loss:0.2773214280605316
              precision    recall  f1-score   support

         0.0       0.80      0.68      0.74       155
         1.0       0.87      0.92      0.89       345

    accuracy                           0.85       500
   macro avg       0.83      0.80      0.82       500
weighted avg       0.85      0.85      0.85       500

准确率: 0.85
AUC: 0.9246750818139318
saved model:  ./model/lstm_6.model
epoch:7, step:10, loss:0.24350357055664062
epoch:7, step:20, loss:0.23487117886543274
epoch:7, step:30, loss:0.22391505539417267
epoch:7, step:40, loss:0.2595963776111603
epoch:7, step:50, loss:0.2179897129535675
epoch:7, step:60, loss:0.2818595767021179
epoch:7, step:70, loss:0.22337505221366882
epoch:7, step:80, loss:0.24199266731739044
epoch:7, step:90, loss:0.2442096471786499
epoch:7, step:100, loss:0.235751673579216
              precision    recall  f1-score   support

         0.0       0.77      0.73      0.75       155
         1.0       0.88      0.90      0.89       345

    accuracy                           0.85       500
   macro avg       0.83      0.82      0.82       500
weighted avg       0.85      0.85      0.85       500

准确率: 0.85
AUC: 0.920074801309023
saved model:  ./model/lstm_7.model
epoch:8, step:10, loss:0.19752326607704163
epoch:8, step:20, loss:0.2149176299571991
epoch:8, step:30, loss:0.243425652384758
epoch:8, step:40, loss:0.20521990954875946
epoch:8, step:50, loss:0.2101530283689499
epoch:8, step:60, loss:0.24390415847301483
epoch:8, step:70, loss:0.1882343590259552
epoch:8, step:80, loss:0.19247908890247345
epoch:8, step:90, loss:0.2051907330751419
epoch:8, step:100, loss:0.2257535755634308
              precision    recall  f1-score   support

         0.0       0.72      0.77      0.75       155
         1.0       0.90      0.87      0.88       345

    accuracy                           0.84       500
   macro avg       0.81      0.82      0.81       500
weighted avg       0.84      0.84      0.84       500

准确率: 0.838
AUC: 0.9210472183263207
saved model:  ./model/lstm_8.model
epoch:9, step:10, loss:0.185001403093338
epoch:9, step:20, loss:0.1537732183933258
epoch:9, step:30, loss:0.16428223252296448
epoch:9, step:40, loss:0.18973180651664734
epoch:9, step:50, loss:0.20276756584644318
epoch:9, step:60, loss:0.181198388338089
epoch:9, step:70, loss:0.16447857022285461
epoch:9, step:80, loss:0.17893412709236145
epoch:9, step:90, loss:0.15202948451042175
epoch:9, step:100, loss:0.18060654401779175
              precision    recall  f1-score   support

         0.0       0.69      0.85      0.77       155
         1.0       0.93      0.83      0.88       345

    accuracy                           0.84       500
   macro avg       0.81      0.84      0.82       500
weighted avg       0.85      0.84      0.84       500

准确率: 0.838
AUC: 0.9292753623188407
saved model:  ./model/lstm_9.model
epoch:10, step:10, loss:0.13128316402435303
epoch:10, step:20, loss:0.19295275211334229
epoch:10, step:30, loss:0.13675585389137268
epoch:10, step:40, loss:0.1531788557767868
epoch:10, step:50, loss:0.12316741049289703
epoch:10, step:60, loss:0.1803867071866989
epoch:10, step:70, loss:0.16651126742362976
epoch:10, step:80, loss:0.1401197612285614
epoch:10, step:90, loss:0.13472476601600647
epoch:10, step:100, loss:0.1456843912601471
              precision    recall  f1-score   support

         0.0       0.77      0.66      0.71       155
         1.0       0.86      0.91      0.88       345

    accuracy                           0.83       500
   macro avg       0.81      0.78      0.80       500
weighted avg       0.83      0.83      0.83       500

准确率: 0.832
AUC: 0.9079756895745675
saved model:  ./model/lstm_10.model
