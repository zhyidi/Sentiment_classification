Building prefix dict from the default dictionary ...
Loading model from cache /tmp/jieba.cache
Loading model cost 0.773 seconds.
Prefix dict has been built successfully.
/home/zhyidi/Graduation_Project/lstm.py:115: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1670525495809/work/torch/csrc/utils/tensor_new.cpp:230.)
  vectors = torch.Tensor(vectors)
epoch:1, step:10, loss:0.6823092699050903
epoch:1, step:20, loss:0.6626048684120178
epoch:1, step:30, loss:0.6285476088523865
epoch:1, step:40, loss:0.5646919012069702
epoch:1, step:50, loss:0.5143587589263916
epoch:1, step:60, loss:0.4562589228153229
epoch:1, step:70, loss:0.47163277864456177
epoch:1, step:80, loss:0.4560585916042328
epoch:1, step:90, loss:0.4322929382324219
epoch:1, step:100, loss:0.47150081396102905
              precision    recall  f1-score   support

         0.0       0.74      0.77      0.76       155
         1.0       0.89      0.88      0.89       345

    accuracy                           0.85       500
   macro avg       0.82      0.82      0.82       500
weighted avg       0.85      0.85      0.85       500

准确率: 0.846
AUC: 0.9086489013557737
saved model:  ./model/lstm_1.model
epoch:2, step:10, loss:0.42813315987586975
epoch:2, step:20, loss:0.4338533878326416
epoch:2, step:30, loss:0.42753657698631287
epoch:2, step:40, loss:0.4105742573738098
epoch:2, step:50, loss:0.4012535512447357
epoch:2, step:60, loss:0.37738460302352905
epoch:2, step:70, loss:0.40861934423446655
epoch:2, step:80, loss:0.384315550327301
epoch:2, step:90, loss:0.3806377351284027
epoch:2, step:100, loss:0.3841317296028137
              precision    recall  f1-score   support

         0.0       0.67      0.85      0.75       155
         1.0       0.92      0.81      0.86       345

    accuracy                           0.82       500
   macro avg       0.80      0.83      0.81       500
weighted avg       0.85      0.82      0.83       500

准确率: 0.824
AUC: 0.9189340813464235
saved model:  ./model/lstm_2.model
epoch:3, step:10, loss:0.34458786249160767
epoch:3, step:20, loss:0.36190134286880493
epoch:3, step:30, loss:0.39099597930908203
epoch:3, step:40, loss:0.3692554831504822
epoch:3, step:50, loss:0.3505677282810211
epoch:3, step:60, loss:0.394572913646698
epoch:3, step:70, loss:0.352887362241745
epoch:3, step:80, loss:0.39105886220932007
epoch:3, step:90, loss:0.38266628980636597
epoch:3, step:100, loss:0.3198876976966858
              precision    recall  f1-score   support

         0.0       0.81      0.73      0.77       155
         1.0       0.88      0.92      0.90       345

    accuracy                           0.86       500
   macro avg       0.85      0.83      0.83       500
weighted avg       0.86      0.86      0.86       500

准确率: 0.862
AUC: 0.9288639551192145
saved model:  ./model/lstm_3.model
epoch:4, step:10, loss:0.3287014961242676
epoch:4, step:20, loss:0.31395310163497925
epoch:4, step:30, loss:0.36151400208473206
epoch:4, step:40, loss:0.3297119736671448
epoch:4, step:50, loss:0.3020966947078705
epoch:4, step:60, loss:0.3327442705631256
epoch:4, step:70, loss:0.3418889045715332
epoch:4, step:80, loss:0.33880701661109924
epoch:4, step:90, loss:0.33783820271492004
epoch:4, step:100, loss:0.3695642650127411
              precision    recall  f1-score   support

         0.0       0.82      0.68      0.74       155
         1.0       0.87      0.93      0.90       345

    accuracy                           0.85       500
   macro avg       0.84      0.81      0.82       500
weighted avg       0.85      0.85      0.85       500

准确率: 0.854
AUC: 0.9284712482468443
saved model:  ./model/lstm_4.model
epoch:5, step:10, loss:0.2985340654850006
epoch:5, step:20, loss:0.29130321741104126
epoch:5, step:30, loss:0.321367084980011
epoch:5, step:40, loss:0.3013855814933777
epoch:5, step:50, loss:0.2936643958091736
epoch:5, step:60, loss:0.3082491159439087
epoch:5, step:70, loss:0.3007151484489441
epoch:5, step:80, loss:0.28460484743118286
epoch:5, step:90, loss:0.3001227080821991
epoch:5, step:100, loss:0.3150520920753479
              precision    recall  f1-score   support

         0.0       0.80      0.79      0.79       155
         1.0       0.90      0.91      0.91       345

    accuracy                           0.87       500
   macro avg       0.85      0.85      0.85       500
weighted avg       0.87      0.87      0.87       500

准确率: 0.872
AUC: 0.9321552127162226
saved model:  ./model/lstm_5.model
epoch:6, step:10, loss:0.2600930333137512
epoch:6, step:20, loss:0.2459484040737152
epoch:6, step:30, loss:0.24443402886390686
epoch:6, step:40, loss:0.2748858332633972
epoch:6, step:50, loss:0.23680956661701202
epoch:6, step:60, loss:0.2629986107349396
epoch:6, step:70, loss:0.29326504468917847
epoch:6, step:80, loss:0.2965015470981598
epoch:6, step:90, loss:0.2659304141998291
epoch:6, step:100, loss:0.23746848106384277
              precision    recall  f1-score   support

         0.0       0.82      0.75      0.78       155
         1.0       0.89      0.93      0.91       345

    accuracy                           0.87       500
   macro avg       0.86      0.84      0.85       500
weighted avg       0.87      0.87      0.87       500

准确率: 0.872
AUC: 0.9335390369331463
saved model:  ./model/lstm_6.model
epoch:7, step:10, loss:0.2169133424758911
epoch:7, step:20, loss:0.2100411355495453
epoch:7, step:30, loss:0.2510219216346741
epoch:7, step:40, loss:0.2198956310749054
epoch:7, step:50, loss:0.2179097682237625
epoch:7, step:60, loss:0.21618132293224335
epoch:7, step:70, loss:0.2073066681623459
epoch:7, step:80, loss:0.22689315676689148
epoch:7, step:90, loss:0.2529218792915344
epoch:7, step:100, loss:0.24934163689613342
              precision    recall  f1-score   support

         0.0       0.83      0.74      0.78       155
         1.0       0.89      0.93      0.91       345

    accuracy                           0.87       500
   macro avg       0.86      0.84      0.85       500
weighted avg       0.87      0.87      0.87       500

准确率: 0.872
AUC: 0.9349228611500702
saved model:  ./model/lstm_7.model
epoch:8, step:10, loss:0.18946203589439392
epoch:8, step:20, loss:0.17566296458244324
epoch:8, step:30, loss:0.1544916033744812
epoch:8, step:40, loss:0.15003520250320435
epoch:8, step:50, loss:0.17459750175476074
epoch:8, step:60, loss:0.17546990513801575
epoch:8, step:70, loss:0.18406453728675842
epoch:8, step:80, loss:0.16886278986930847
epoch:8, step:90, loss:0.2030799686908722
epoch:8, step:100, loss:0.2300454080104828
              precision    recall  f1-score   support

         0.0       0.77      0.74      0.75       155
         1.0       0.88      0.90      0.89       345

    accuracy                           0.85       500
   macro avg       0.83      0.82      0.82       500
weighted avg       0.85      0.85      0.85       500

准确率: 0.85
AUC: 0.9263394109396914
saved model:  ./model/lstm_8.model
epoch:9, step:10, loss:0.12552013993263245
epoch:9, step:20, loss:0.14392635226249695
epoch:9, step:30, loss:0.16298823058605194
epoch:9, step:40, loss:0.1661599576473236
epoch:9, step:50, loss:0.18222427368164062
epoch:9, step:60, loss:0.1415507048368454
epoch:9, step:70, loss:0.13278326392173767
epoch:9, step:80, loss:0.15434008836746216
epoch:9, step:90, loss:0.16132372617721558
epoch:9, step:100, loss:0.1363077312707901
              precision    recall  f1-score   support

         0.0       0.73      0.85      0.78       155
         1.0       0.93      0.86      0.89       345

    accuracy                           0.85       500
   macro avg       0.83      0.85      0.84       500
weighted avg       0.86      0.85      0.86       500

准确率: 0.854
AUC: 0.9328284244974286
saved model:  ./model/lstm_9.model
epoch:10, step:10, loss:0.12856517732143402
epoch:10, step:20, loss:0.09242163598537445
epoch:10, step:30, loss:0.12212930619716644
epoch:10, step:40, loss:0.09799067676067352
epoch:10, step:50, loss:0.09612594544887543
epoch:10, step:60, loss:0.112540602684021
epoch:10, step:70, loss:0.12325112521648407
epoch:10, step:80, loss:0.11383022367954254
epoch:10, step:90, loss:0.10205294191837311
epoch:10, step:100, loss:0.13018015027046204
              precision    recall  f1-score   support

         0.0       0.74      0.84      0.79       155
         1.0       0.92      0.87      0.89       345

    accuracy                           0.86       500
   macro avg       0.83      0.85      0.84       500
weighted avg       0.87      0.86      0.86       500

准确率: 0.858
AUC: 0.933015427769986
saved model:  ./model/lstm_10.model
