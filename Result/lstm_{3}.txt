Building prefix dict from the default dictionary ...
Loading model from cache /tmp/jieba.cache
Loading model cost 0.708 seconds.
Prefix dict has been built successfully.
/home/zhyidi/Graduation_Project/lstm.py:115: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1670525495809/work/torch/csrc/utils/tensor_new.cpp:230.)
  vectors = torch.Tensor(vectors)
epoch:1, step:10, loss:0.6887378692626953
epoch:1, step:20, loss:0.6691452860832214
epoch:1, step:30, loss:0.6434570550918579
epoch:1, step:40, loss:0.5916849374771118
epoch:1, step:50, loss:0.49936962127685547
epoch:1, step:60, loss:0.48615163564682007
epoch:1, step:70, loss:0.5023633241653442
epoch:1, step:80, loss:0.4715743064880371
epoch:1, step:90, loss:0.4614960253238678
epoch:1, step:100, loss:0.4742346405982971
              precision    recall  f1-score   support

         0.0       0.76      0.80      0.78       155
         1.0       0.91      0.89      0.90       345

    accuracy                           0.86       500
   macro avg       0.83      0.84      0.84       500
weighted avg       0.86      0.86      0.86       500

准确率: 0.86
AUC: 0.9133800841514726
saved model:  ./model/lstm_1.model
epoch:2, step:10, loss:0.430381715297699
epoch:2, step:20, loss:0.428140252828598
epoch:2, step:30, loss:0.4113059937953949
epoch:2, step:40, loss:0.4048479497432709
epoch:2, step:50, loss:0.45044827461242676
epoch:2, step:60, loss:0.4165366291999817
epoch:2, step:70, loss:0.38419437408447266
epoch:2, step:80, loss:0.36999961733818054
epoch:2, step:90, loss:0.42477545142173767
epoch:2, step:100, loss:0.4168112874031067
              precision    recall  f1-score   support

         0.0       0.75      0.79      0.77       155
         1.0       0.91      0.88      0.89       345

    accuracy                           0.86       500
   macro avg       0.83      0.84      0.83       500
weighted avg       0.86      0.86      0.86       500

准确率: 0.856
AUC: 0.9196072931276298
saved model:  ./model/lstm_2.model
epoch:3, step:10, loss:0.3793712258338928
epoch:3, step:20, loss:0.3612430691719055
epoch:3, step:30, loss:0.37238937616348267
epoch:3, step:40, loss:0.3791351616382599
epoch:3, step:50, loss:0.40281254053115845
epoch:3, step:60, loss:0.3589686155319214
epoch:3, step:70, loss:0.3570135235786438
epoch:3, step:80, loss:0.3773801624774933
epoch:3, step:90, loss:0.34839844703674316
epoch:3, step:100, loss:0.3813415467739105
              precision    recall  f1-score   support

         0.0       0.78      0.74      0.75       155
         1.0       0.88      0.90      0.89       345

    accuracy                           0.85       500
   macro avg       0.83      0.82      0.82       500
weighted avg       0.85      0.85      0.85       500

准确率: 0.852
AUC: 0.9203927068723702
saved model:  ./model/lstm_3.model
epoch:4, step:10, loss:0.3477049767971039
epoch:4, step:20, loss:0.3292270600795746
epoch:4, step:30, loss:0.35222044587135315
epoch:4, step:40, loss:0.3755996823310852
epoch:4, step:50, loss:0.3134850859642029
epoch:4, step:60, loss:0.3591112196445465
epoch:4, step:70, loss:0.3495427966117859
epoch:4, step:80, loss:0.32982584834098816
epoch:4, step:90, loss:0.33009207248687744
epoch:4, step:100, loss:0.37298959493637085
              precision    recall  f1-score   support

         0.0       0.61      0.92      0.74       155
         1.0       0.96      0.74      0.83       345

    accuracy                           0.80       500
   macro avg       0.78      0.83      0.79       500
weighted avg       0.85      0.80      0.80       500

准确率: 0.796
AUC: 0.9285086489013558
saved model:  ./model/lstm_4.model
epoch:5, step:10, loss:0.3218814432621002
epoch:5, step:20, loss:0.3265794813632965
epoch:5, step:30, loss:0.31424471735954285
epoch:5, step:40, loss:0.3055886924266815
epoch:5, step:50, loss:0.3024941384792328
epoch:5, step:60, loss:0.2946614623069763
epoch:5, step:70, loss:0.2867000699043274
epoch:5, step:80, loss:0.29595592617988586
epoch:5, step:90, loss:0.3212414085865021
epoch:5, step:100, loss:0.3176887035369873
              precision    recall  f1-score   support

         0.0       0.77      0.79      0.78       155
         1.0       0.90      0.89      0.90       345

    accuracy                           0.86       500
   macro avg       0.84      0.84      0.84       500
weighted avg       0.86      0.86      0.86       500

准确率: 0.86
AUC: 0.9277606358111267
saved model:  ./model/lstm_5.model
epoch:6, step:10, loss:0.23446543514728546
epoch:6, step:20, loss:0.2926143407821655
epoch:6, step:30, loss:0.2712702453136444
epoch:6, step:40, loss:0.2728464603424072
epoch:6, step:50, loss:0.2720509171485901
epoch:6, step:60, loss:0.28035929799079895
epoch:6, step:70, loss:0.2778182029724121
epoch:6, step:80, loss:0.25909632444381714
epoch:6, step:90, loss:0.2741304039955139
epoch:6, step:100, loss:0.28734633326530457
              precision    recall  f1-score   support

         0.0       0.79      0.79      0.79       155
         1.0       0.90      0.91      0.91       345

    accuracy                           0.87       500
   macro avg       0.85      0.85      0.85       500
weighted avg       0.87      0.87      0.87       500

准确率: 0.87
AUC: 0.9302290790088825
saved model:  ./model/lstm_6.model
epoch:7, step:10, loss:0.21376332640647888
epoch:7, step:20, loss:0.2519872784614563
epoch:7, step:30, loss:0.2313367873430252
epoch:7, step:40, loss:0.2153395414352417
epoch:7, step:50, loss:0.222572922706604
epoch:7, step:60, loss:0.22014670073986053
epoch:7, step:70, loss:0.23512141406536102
epoch:7, step:80, loss:0.2131480723619461
epoch:7, step:90, loss:0.27028295397758484
epoch:7, step:100, loss:0.2743711769580841
              precision    recall  f1-score   support

         0.0       0.70      0.88      0.78       155
         1.0       0.94      0.83      0.88       345

    accuracy                           0.85       500
   macro avg       0.82      0.86      0.83       500
weighted avg       0.87      0.85      0.85       500

准确率: 0.848
AUC: 0.9285834502103787
saved model:  ./model/lstm_7.model
epoch:8, step:10, loss:0.2435908019542694
epoch:8, step:20, loss:0.22777080535888672
epoch:8, step:30, loss:0.2056860625743866
epoch:8, step:40, loss:0.18653622269630432
epoch:8, step:50, loss:0.1753748655319214
epoch:8, step:60, loss:0.16960285604000092
epoch:8, step:70, loss:0.15741583704948425
epoch:8, step:80, loss:0.1629343032836914
epoch:8, step:90, loss:0.2204248011112213
epoch:8, step:100, loss:0.1976347416639328
              precision    recall  f1-score   support

         0.0       0.77      0.80      0.78       155
         1.0       0.91      0.89      0.90       345

    accuracy                           0.86       500
   macro avg       0.84      0.85      0.84       500
weighted avg       0.87      0.86      0.86       500

准确率: 0.864
AUC: 0.921439925198691
saved model:  ./model/lstm_8.model
epoch:9, step:10, loss:0.1490362584590912
epoch:9, step:20, loss:0.1558384895324707
epoch:9, step:30, loss:0.18087531626224518
epoch:9, step:40, loss:0.15983471274375916
epoch:9, step:50, loss:0.1269373595714569
epoch:9, step:60, loss:0.13556313514709473
epoch:9, step:70, loss:0.17207354307174683
epoch:9, step:80, loss:0.13069278001785278
epoch:9, step:90, loss:0.18277272582054138
epoch:9, step:100, loss:0.19928821921348572
              precision    recall  f1-score   support

         0.0       0.80      0.61      0.69       155
         1.0       0.84      0.93      0.88       345

    accuracy                           0.83       500
   macro avg       0.82      0.77      0.79       500
weighted avg       0.83      0.83      0.82       500

准确率: 0.83
AUC: 0.9122393641888733
saved model:  ./model/lstm_9.model
epoch:10, step:10, loss:0.16408571600914001
epoch:10, step:20, loss:0.14228466153144836
epoch:10, step:30, loss:0.10756509006023407
epoch:10, step:40, loss:0.10588172823190689
epoch:10, step:50, loss:0.12370581924915314
epoch:10, step:60, loss:0.09358815848827362
epoch:10, step:70, loss:0.13368776440620422
epoch:10, step:80, loss:0.11405332386493683
epoch:10, step:90, loss:0.1292257010936737
epoch:10, step:100, loss:0.1473894715309143
              precision    recall  f1-score   support

         0.0       0.76      0.77      0.77       155
         1.0       0.90      0.89      0.89       345

    accuracy                           0.85       500
   macro avg       0.83      0.83      0.83       500
weighted avg       0.85      0.85      0.85       500

准确率: 0.854
AUC: 0.9165778401122019
saved model:  ./model/lstm_10.model
